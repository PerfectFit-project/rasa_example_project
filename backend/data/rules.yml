version: "3.1"

rules:


- rule: handle message with low NLU confidence
  steps:
  - intent: nlu_fallback
  - action: utter_default
  - action: utter_default_close_session
  - action: action_end_dialog


- rule: start session and successful session load
  steps:
  - intent: start_session1
  - action: action_load_session_first
  - slot_was_set:
    - session_loaded: true
  - action: utter_greet_1
  - action: utter_greet_2
  - action: utter_confirm_mood

- rule: start session and unsuccessful session load
  steps:
  - intent: start_session1
  - action: action_load_session_first
  - slot_was_set:
    - session_loaded: false
  - action: utter_default_close_session
  - action: action_end_dialog


- rule: mood good explain purpose
  steps:
  - intent: confirm_mood_good
  - action: utter_mood_good_response  
  - action: utter_purpose_1
  - action: utter_purpose_2
  - action: utter_purpose_3
  - action: utter_purpose_4
  - action: utter_purpose_5
  - action: utter_purpose_6
  - action: utter_purpose_7
  - action: utter_confirm_purpose

- rule: mood neutral explain purpose 
  steps:
  - intent: confirm_mood_neutral
  - action: utter_mood_neutral_response
  - action: utter_purpose_1
  - action: utter_purpose_2
  - action: utter_purpose_3
  - action: utter_purpose_4
  - action: utter_purpose_5
  - action: utter_purpose_6
  - action: utter_purpose_7
  - action: utter_confirm_purpose

- rule: mood bad explain purpose
  steps:
  - intent: confirm_mood_bad
  - action: utter_mood_bad_response
  - action: utter_purpose_1
  - action: utter_purpose_2
  - action: utter_purpose_3
  - action: utter_purpose_4
  - action: utter_purpose_5
  - action: utter_purpose_6
  - action: utter_purpose_7
  - action: utter_confirm_purpose


- rule: confirm purpose explain usage
  steps:
  - intent: confirm_purpose
  - action: utter_prompt_usage
  - action: utter_explain_usage


- rule: internal motivation
  steps:
  - intent: confirm_usage
  - action: utter_internal_moivation_1
  - action: utter_internal_moivation_2
  - action: utter_internal_moivation_question

- rule: explain why planning is useful
  steps:
  - intent: confirm_motivation
  - action: utter_explain_usefulness_planning_1
  - action: utter_explain_usefulness_planning_2
  - action: utter_explain_usefulness_planning_3
  - action: utter_explain_usefulness_planning_4
  - action: utter_explain_usefulness_planning_question

- rule: ask about routines monday
  steps:
  - intent: confirm_usefulnes_planning_intro
  - action: utter_routines_1
  - action: utter_routines_2
  - action: utter_routines_3
  - action: utter_routines_4
  - action: utter_routines_monday

- rule: ask about routines monday repeat
  steps:
  - intent: confirm_monday
  - action: utter_routines_monday_repeat

- rule: no more free on mondays
  steps: 
  - intent: confirm_monday_continue
  # - action: utter_confirm_monday_slots
  - action: utter_routines_tuesday

- rule: ask about routines tuesday repeat
  steps:
  - intent: confirm_tuesday
  - action: utter_routines_tuesday_repeat

- rule: no more free on tuesdays
  steps: 
  - intent: confirm_tuesday_continue
  # - action: utter_confirm_tuesday_slots
  - action: utter_routines_wednesday

- rule: ask about routines wednesday repeat
  steps:
  - intent: confirm_wednesday
  - action: utter_routines_wednesday_repeat

- rule: no more free on wednesdays
  steps: 
  - intent: confirm_wednesday_continue
  # - action: utter_confirm_wednesday_slots
  - action: utter_routines_thursday

- rule: ask about routines thursday repeat
  steps:
  - intent: confirm_thursday
  - action: utter_routines_thursday_repeat

- rule: no more free on thursdays
  steps: 
  - intent: confirm_thursday_continue
  # - action: utter_confirm_thursday_slots
  - action: utter_routines_friday

- rule: ask about routines friday repeat
  steps:
  - intent: confirm_friday
  - action: utter_routines_friday_repeat

- rule: no more free on fridays
  steps: 
  - intent: confirm_friday_continue
  # - action: utter_confirm_friday_slots
  - action: utter_routines_saturday

- rule: ask about routines saturday repeat
  steps:
  - intent: confirm_saturday
  - action: utter_routines_saturday_repeat

- rule: no more free on saturdays
  steps: 
  - intent: confirm_saturday_continue
  # - action: utter_confirm_saturday_slots
  - action: utter_routines_sunday

- rule: ask about routines sunday repeat
  steps:
  - intent: confirm_sunday
  - action: utter_routines_sunday_repeat

- rule: no more free on sundays
  steps: 
  - intent: confirm_sunday_continue
  # - action: utter_confirm_sunday_slots
  - action: utter_thank_for_times
  - action: utter_energy_levels
  - action: utter_energy_levels_weekdays_morning

- rule: confirm energy levels morning ask for midday
  steps: 
  - intent: confirm_weekdays_morning
  - action: utter_energy_levels_weekdays_midday

- rule: confirm energy levels midday ask for afternoon
  steps: 
  - intent: confirm_weekdays_midday
  - action: utter_energy_levels_weekdays_afternoon
  

- rule: confirm energy levels afternoon ask for evening
  steps: 
  - intent: confirm_weekdays_afternoon
  - action: utter_energy_levels_weekdays_evening


- rule: confirm energy levels evening ask for weekend morning
  steps: 
  - intent: confirm_weekdays_evening
  # - action: utter_energy_levels_weekdays_confirm
  - action: utter_energy_levels_weekends_morning


- rule: confirm energy levels weekend morning ask for weekend midday
  steps: 
  - intent: confirm_weekends_morning
  - action: utter_energy_levels_weekends_midday

  
- rule: confirm energy levels weekend midday ask for weekend afternoon
  steps: 
  - intent: confirm_weekends_midday
  - action: utter_energy_levels_weekends_afternoon
  

- rule: confirm energy levels weekend afternoon ask for weekend evening
  steps: 
  - intent: confirm_weekends_afternoon
  - action: utter_energy_levels_weekends_evening


- rule: confirm energy levels weekend evening
  steps: 
  - intent: confirm_weekends_evening
  # - action: utter_energy_levels_weekends_confirm
  - action: utter_thank_for_energy_levels
  - action: utter_goal_1
  - action: utter_goal_2
  - action: utter_goal_3
  - action: utter_set_goal

- rule: confirm goal
  steps: 
  - intent: confirm_goal
  - action: utter_confirm_goal
  
- rule: create initial plan
  steps:
  - intent: confirm_initial_plan
  - action: action_create_initial_plan
  - action: utter_present_plan_1
  - action: utter_present_plan_2

- rule: intro state variables ask confidence
  steps:
  - intent: confirm_checked_plan
  - action: utter_state_variables_intro_1
  - action: utter_state_variables_intro_2

- rule: loop asking for state and doing actions
  steps:
  - intent: confirm_state
  - action: utter_state_confidence

- rule: confirm confidence ask perceived usefulness
  steps:
  - intent: confirm_confidence
  # - action: utter_confidence_repeat
  - action: utter_state_perceived_usefulness

- rule: confirm perceived usefulness ask attitude
  steps:
  - intent: confirm_perceived_usefulness
  # - action: utter_perceived_usefulness_repeat
  - action: utter_state_attitude

- rule: confirm attitude do action ask confidence
  steps:
  - intent: confirm_attitude
  # - action: utter_attitude_repeat
  - action: action_save_event_state
  - action: action_select_action_and_save
  - action: utter_action_finished_loop_back

- rule: confirm actions done
  steps:
  - intent: confirm_actions_done
  - action: utter_satisfaction

- rule: confirm satisfaction ask commitment first week
  steps:
  - intent: confirm_satisfaction
  - action: utter_commitment_1

- rule: confirm commitment first week ask commitment whole plan
  steps:
  - intent: confirm_commitment_1
  - action: utter_commitment_f

- rule: confirm commitment whole plan ask confidence goal
  steps:
  - intent: confirm_commitment_f
  - action: utter_confidence_goal

- rule: confirm confidence goal utter end and save to db
  steps:
  - intent: confirm_confidence_goal
  - action: utter_thank
  - action: utter_email_reminder
  - action: utter_prolific_link
  - action: utter_goodbye
  - action: action_save_goal_plans_and_reward


- rule: goodbye
  steps:
  - intent: confirm_state_pa
  - action: utter_goodbye

- rule: end
  steps:
  - intent: confirm_goodbye
  - action: utter_final_close_session
  - action: action_end_dialog
